# AI ì–´ì‹œìŠ¤í„´íŠ¸ ì±„íŒ… UX ê³ ë„í™” ê³„íš

**ì‘ì„±ì¼**: 2024-12-19  
**ê¸°ì¤€**: Vercel v0 iOS ì•± ê¸°ìˆ  ë¶„ì„ ë¬¸ì„œ  
**ëª©í‘œ**: ë„¤ì´í‹°ë¸Œ ìˆ˜ì¤€ì˜ ë¶€ë“œëŸ½ê³  ì¦ê±°ìš´ ì±„íŒ… ê²½í—˜ êµ¬í˜„

---

## ğŸ“‹ ëª©ì°¨

1. [í˜„ì¬ ìƒíƒœ ë¶„ì„](#1-í˜„ì¬-ìƒíƒœ-ë¶„ì„)
2. [í•µì‹¬ ê°œì„  ì˜ì—­](#2-í•µì‹¬-ê°œì„ -ì˜ì—­)
3. [êµ¬ì²´ì  êµ¬í˜„ ë°©ì•ˆ](#3-êµ¬ì²´ì -êµ¬í˜„-ë°©ì•ˆ)
4. [ìš°ì„ ìˆœìœ„ ë° ë¡œë“œë§µ](#4-ìš°ì„ ìˆœìœ„-ë°-ë¡œë“œë§µ)

---

## 1. í˜„ì¬ ìƒíƒœ ë¶„ì„

### 1.1 í˜„ì¬ êµ¬í˜„ëœ ê¸°ëŠ¥

âœ… **ê¸°ë³¸ ê¸°ëŠ¥**
- ìŠ¤íŠ¸ë¦¬ë° ë©”ì‹œì§€ ì§€ì›
- ê¸°ë³¸ íƒ€ì´í•‘ íš¨ê³¼ (ì»¤ì„œ ê¹œë¹¡ì„)
- ë©”ì‹œì§€ í˜ì´ë“œì¸ ì• ë‹ˆë©”ì´ì…˜
- í‚¤ë³´ë“œ Enter ì „ì†¡
- ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ

âš ï¸ **ê°œì„  í•„ìš” ì˜ì—­**
- ìŠ¤íŠ¸ë¦¬ë° ì½˜í…ì¸ ê°€ í•œ ë²ˆì— ë‚˜íƒ€ë‚¨ (ìŠ¤íƒœê±°ë“œ í˜ì´ë“œ ì—†ìŒ)
- ë©”ì‹œì§€ ì „ì†¡ ì‹œ ë‹¨ìˆœ í˜ì´ë“œì¸ë§Œ (ìŠ¬ë¼ì´ë“œ ì• ë‹ˆë©”ì´ì…˜ ì—†ìŒ)
- ì»´í¬ì €ê°€ ê³ ì • ìœ„ì¹˜ (í”Œë¡œíŒ… íš¨ê³¼ ì—†ìŒ)
- í‚¤ë³´ë“œ ìƒíƒœì— ë”°ë¥¸ ìŠ¤í¬ë¡¤ ì¡°ì • ë¶€ì¡±
- ë™ì  ë†’ì´ ì²˜ë¦¬ ê¸°ë³¸ì 

---

## 2. í•µì‹¬ ê°œì„  ì˜ì—­

### 2.1 ìŠ¤íŠ¸ë¦¬ë° ì½˜í…ì¸  ìŠ¤íƒœê±°ë“œ í˜ì´ë“œ ì• ë‹ˆë©”ì´ì…˜ â­ **ìµœìš°ì„ **

**ëª©í‘œ**: AI ì‘ë‹µì´ ìŠ¤íŠ¸ë¦¬ë°ë  ë•Œ ë‹¨ì–´/ë¬¸ì¥ ë‹¨ìœ„ë¡œ ìˆœì°¨ì ìœ¼ë¡œ í˜ì´ë“œì¸ë˜ì–´ ë¶€ë“œëŸ¬ìš´ íƒ€ì´í•‘ ëŠë‚Œ ì œê³µ

**ê¸°ëŒ€ íš¨ê³¼**:
- ë” ìì—°ìŠ¤ëŸ¬ìš´ AI ì‘ë‹µ ê²½í—˜
- ì‚¬ìš©ìê°€ ì‘ë‹µì„ ì½ëŠ” ë™ì•ˆ ì‹œê°ì  í”¼ë“œë°± ì œê³µ
- ë„¤ì´í‹°ë¸Œ ì•± ìˆ˜ì¤€ì˜ ë¶€ë“œëŸ¬ìš´ ëŠë‚Œ

**ê¸°ìˆ  ìš”êµ¬ì‚¬í•­**:
- Framer Motion ë˜ëŠ” CSS ì• ë‹ˆë©”ì´ì…˜ í™œìš©
- í…ìŠ¤íŠ¸ë¥¼ ë‹¨ì–´/ë¬¸ì¥ ë‹¨ìœ„ë¡œ ë¶„í• 
- ë™ì‹œì— ì• ë‹ˆë©”ì´ì…˜ë˜ëŠ” ìš”ì†Œ ìˆ˜ ì œí•œ (í’€ ê¸°ë°˜ ê´€ë¦¬)
- ì¬ì• ë‹ˆë©”ì´ì…˜ ë°©ì§€ (ì´ë¯¸ ë³¸ ì½˜í…ì¸ )

### 2.2 ë©”ì‹œì§€ ì „ì†¡ ì• ë‹ˆë©”ì´ì…˜ â­ **ë†’ì€ ìš°ì„ ìˆœìœ„**

**ëª©í‘œ**: ì‚¬ìš©ì ë©”ì‹œì§€ê°€ ìœ„ë¡œ ìŠ¬ë¼ì´ë“œë˜ë©´ì„œ ì‚¬ë¼ì§€ê³ , AI ì‘ë‹µì´ ë¶€ë“œëŸ½ê²Œ í˜ì´ë“œì¸

**ê¸°ëŒ€ íš¨ê³¼**:
- ë©”ì‹œì§€ ì „ì†¡ì˜ ì‹œê°ì  í”¼ë“œë°± ê°•í™”
- ëŒ€í™” íë¦„ì˜ ìì—°ìŠ¤ëŸ¬ì›€ í–¥ìƒ
- ì‚¬ìš©ì ë§Œì¡±ë„ ì¦ê°€

**ê¸°ìˆ  ìš”êµ¬ì‚¬í•­**:
- ì‚¬ìš©ì ë©”ì‹œì§€ ë†’ì´ ì¸¡ì •
- translateY ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ìœ„ë¡œ ìŠ¬ë¼ì´ë“œ
- ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ AI ì‘ë‹µ í˜ì´ë“œì¸
- Framer Motion ë˜ëŠ” CSS Transform í™œìš©

### 2.3 í”Œë¡œíŒ… ì»´í¬ì € (Glass Morphism) â­ **ì¤‘ê°„ ìš°ì„ ìˆœìœ„**

**ëª©í‘œ**: iOS 26 iMessage ìŠ¤íƒ€ì¼ì˜ ë°˜íˆ¬ëª… ë– ìˆëŠ” ì»´í¬ì € êµ¬í˜„

**ê¸°ëŒ€ íš¨ê³¼**:
- í˜„ëŒ€ì ì´ê³  ì„¸ë ¨ëœ ë””ìì¸
- ë„¤ì´í‹°ë¸Œ ì•±ê³¼ ìœ ì‚¬í•œ ê²½í—˜
- ì‹œê°ì  ê³„ì¸µ êµ¬ì¡° ëª…í™•í™”

**ê¸°ìˆ  ìš”êµ¬ì‚¬í•­**:
- CSS backdrop-filter (glass morphism)
- position: fixed + bottom: 0
- í‚¤ë³´ë“œ ìƒíƒœì— ë”°ë¥¸ ìœ„ì¹˜ ì¡°ì •
- ì»´í¬ì € ë†’ì´ ë³€í™” ì‹œ ìŠ¤í¬ë¡¤ ì¡°ì •

### 2.4 ë™ì  ë†’ì´ ë° ìŠ¤í¬ë¡¤ ê´€ë¦¬ â­ **ì¤‘ê°„ ìš°ì„ ìˆœìœ„**

**ëª©í‘œ**: Blank Size ê°œë…ì„ ì›¹ì— ì ìš©í•˜ì—¬ ë™ì  ë©”ì‹œì§€ ë†’ì´ì™€ í‚¤ë³´ë“œ ìƒíƒœë¥¼ ì •í™•íˆ ì²˜ë¦¬

**ê¸°ëŒ€ íš¨ê³¼**:
- ë©”ì‹œì§€ê°€ í•­ìƒ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì— í‘œì‹œ
- í‚¤ë³´ë“œ ì—´ë¦¼/ë‹«í˜ ì‹œ ë¶€ë“œëŸ¬ìš´ ì „í™˜
- ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì •í™•ë„ í–¥ìƒ

**ê¸°ìˆ  ìš”êµ¬ì‚¬í•­**:
- ë§ˆì§€ë§‰ ë©”ì‹œì§€ í•˜ë‹¨ê³¼ ë·°í¬íŠ¸ ë ì‚¬ì´ì˜ ê±°ë¦¬ ê³„ì‚°
- ë™ì  padding-bottom ì ìš©
- í‚¤ë³´ë“œ ìƒíƒœ ê°ì§€ ë° ë°˜ì‘
- Intersection Observer í™œìš©

### 2.5 ì»´í¬ì €ë¸” ì±„íŒ… êµ¬ì¡° â­ **ë‚®ì€ ìš°ì„ ìˆœìœ„**

**ëª©í‘œ**: Context Provider ê¸°ë°˜ì˜ ëª¨ë“ˆí™”ëœ êµ¬ì¡°ë¡œ í™•ì¥ì„± í–¥ìƒ

**ê¸°ëŒ€ íš¨ê³¼**:
- ê¸°ëŠ¥ë³„ ë…ë¦½ì  ê°œë°œ ê°€ëŠ¥
- ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ
- í…ŒìŠ¤íŠ¸ ìš©ì´ì„± ì¦ê°€

**ê¸°ìˆ  ìš”êµ¬ì‚¬í•­**:
- React Context API
- ì»¤ìŠ¤í…€ í›… ê¸°ë°˜ ê¸°ëŠ¥ ë¶„ë¦¬
- Provider ì»´í¬ì§€ì…˜

### 2.6 í‚¤ë³´ë“œ ì¸ì‹ ê°œì„  â­ **ì¤‘ê°„ ìš°ì„ ìˆœìœ„**

**ëª©í‘œ**: í‚¤ë³´ë“œ ìƒíƒœì— ë”°ë¥¸ ìŠ¤ë§ˆíŠ¸í•œ ìŠ¤í¬ë¡¤ ì¡°ì •

**ê¸°ëŒ€ íš¨ê³¼**:
- í‚¤ë³´ë“œ ì—´ë¦¼/ë‹«í˜ ì‹œ ìì—°ìŠ¤ëŸ¬ìš´ ë™ì‘
- ì…ë ¥ ì¤‘ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ìœ ì§€
- ëª¨ë°”ì¼ ê²½í—˜ í–¥ìƒ

**ê¸°ìˆ  ìš”êµ¬ì‚¬í•­**:
- Visual Viewport API í™œìš©
- í‚¤ë³´ë“œ ë†’ì´ ê°ì§€
- ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ê³„ì‚° ë° ì¡°ì •

---

## 3. êµ¬ì²´ì  êµ¬í˜„ ë°©ì•ˆ

### 3.1 ìŠ¤íŠ¸ë¦¬ë° ì½˜í…ì¸  ìŠ¤íƒœê±°ë“œ í˜ì´ë“œ ì• ë‹ˆë©”ì´ì…˜

#### 3.1.1 ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```typescript
// frontend/components/chat/StaggeredFadeText.tsx

'use client'

import { motion, AnimatePresence } from 'framer-motion'
import { useState, useEffect, useRef } from 'react'

interface StaggeredFadeTextProps {
  text: string
  isStreaming: boolean
  staggerDelay?: number // ms ë‹¨ìœ„ ì§€ì—° (ê¸°ë³¸: 32ms)
  maxConcurrent?: number // ë™ì‹œì— ì• ë‹ˆë©”ì´ì…˜ë˜ëŠ” ìµœëŒ€ ìš”ì†Œ ìˆ˜ (ê¸°ë³¸: 4)
}

// í’€ ê¸°ë°˜ ì• ë‹ˆë©”ì´ì…˜ ìƒíƒœ ê´€ë¦¬
function useAnimationPool(maxSize: number = 4) {
  const [pool, setPool] = useState<Set<string>>(new Set())
  const queueRef = useRef<string[]>([])

  const requestAnimation = (id: string): boolean => {
    if (pool.size < maxSize) {
      setPool(prev => new Set([...prev, id]))
      return true
    } else {
      queueRef.current.push(id)
      return false
    }
  }

  const releaseAnimation = (id: string) => {
    setPool(prev => {
      const next = new Set(prev)
      next.delete(id)
      return next
    })

    // íì—ì„œ ë‹¤ìŒ í•­ëª© ì²˜ë¦¬
    if (queueRef.current.length > 0) {
      const nextId = queueRef.current.shift()!
      setPool(prev => new Set([...prev, nextId]))
    }
  }

  return { requestAnimation, releaseAnimation, poolSize: pool.size }
}

export function StaggeredFadeText({ 
  text, 
  isStreaming, 
  staggerDelay = 32,
  maxConcurrent = 4 
}: StaggeredFadeTextProps) {
  const { requestAnimation, releaseAnimation } = useAnimationPool(maxConcurrent)
  const [words, setWords] = useState<string[]>([])
  const [animatedWords, setAnimatedWords] = useState<Set<number>>(new Set())
  const wordIdCounter = useRef(0)

  // í…ìŠ¤íŠ¸ë¥¼ ë‹¨ì–´ë¡œ ë¶„í• 
  useEffect(() => {
    if (!text) {
      setWords([])
      return
    }

    // ê³µë°±ì„ ê¸°ì¤€ìœ¼ë¡œ ë¶„í• í•˜ë˜, ê³µë°±ë„ ìœ ì§€
    const newWords = text.split(/(\s+)/).filter(w => w.length > 0)
    setWords(newWords)
  }, [text])

  // ìƒˆ ë‹¨ì–´ì— ì• ë‹ˆë©”ì´ì…˜ ì ìš©
  useEffect(() => {
    if (!isStreaming || words.length === 0) return

    const lastIndex = words.length - 1
    if (animatedWords.has(lastIndex)) return

    const wordId = `word-${wordIdCounter.current++}`
    const canAnimate = requestAnimation(wordId)

    if (canAnimate) {
      setAnimatedWords(prev => new Set([...prev, lastIndex]))
      
      // ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ í’€ì—ì„œ ì œê±°
      setTimeout(() => {
        releaseAnimation(wordId)
      }, 300) // í˜ì´ë“œì¸ ì• ë‹ˆë©”ì´ì…˜ ì‹œê°„
    }
  }, [words, isStreaming, animatedWords, requestAnimation, releaseAnimation])

  return (
    <span className="whitespace-pre-wrap break-words leading-relaxed">
      {words.map((word, index) => {
        const isAnimated = animatedWords.has(index)
        const delay = index * staggerDelay

        if (!isAnimated && isStreaming) {
          // ì•„ì§ ì• ë‹ˆë©”ì´ì…˜ë˜ì§€ ì•Šì€ ë‹¨ì–´ëŠ” íˆ¬ëª…í•˜ê²Œ
          return (
            <span key={index} className="opacity-0">
              {word}
            </span>
          )
        }

        return (
          <motion.span
            key={index}
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{
              duration: 0.3,
              delay: delay / 1000,
              ease: 'easeOut'
            }}
            className="inline"
          >
            {word}
          </motion.span>
        )
      })}
    </span>
  )
}
```

#### 3.1.2 ì±„íŒ… í˜ì´ì§€ í†µí•©

```typescript
// frontend/app/chat/page.tsx ìˆ˜ì •

import { StaggeredFadeText } from '@/components/chat/StaggeredFadeText'

// ìŠ¤íŠ¸ë¦¬ë° ì¤‘ì¸ ë©”ì‹œì§€ í‘œì‹œ ë¶€ë¶„ ìˆ˜ì •
{isStreaming && streamingContent && (
  <div className="flex justify-start">
    <div className="max-w-[85%] rounded-2xl px-4 py-3 bg-white border border-slate-200 text-slate-900 shadow-sm">
      <div className="flex items-center gap-1.5 text-xs font-semibold text-slate-500 mb-2">
        <span>{AGENT_META[selectedAgent]?.icon || 'ğŸ¤–'}</span>
        <span className="flex items-center gap-1">
          <span className="animate-pulse">ì‘ë‹µ ì¤‘</span>
          <span className="flex gap-0.5">
            <span className="w-1 h-1 bg-slate-400 rounded-full animate-bounce" style={{ animationDelay: '0ms' }} />
            <span className="w-1 h-1 bg-slate-400 rounded-full animate-bounce" style={{ animationDelay: '150ms' }} />
            <span className="w-1 h-1 bg-slate-400 rounded-full animate-bounce" style={{ animationDelay: '300ms' }} />
          </span>
        </span>
      </div>
      <StaggeredFadeText 
        text={streamingContent}
        isStreaming={isStreaming}
        staggerDelay={32}
        maxConcurrent={4}
      />
      <span className="inline-block w-2 h-4 bg-primary animate-pulse ml-1 rounded" style={{ animation: 'blink 1s infinite' }} />
    </div>
  </div>
)}
```

### 3.2 ë©”ì‹œì§€ ì „ì†¡ ì• ë‹ˆë©”ì´ì…˜

#### 3.2.1 ë©”ì‹œì§€ ì• ë‹ˆë©”ì´ì…˜ í›…

```typescript
// frontend/hooks/useMessageSendAnimation.ts

import { useState, useRef, useEffect } from 'react'
import { motion, useMotionValue, useTransform, animate } from 'framer-motion'

interface UseMessageSendAnimationOptions {
  onAnimationComplete?: () => void
  messageIndex: number
  isUserMessage: boolean
}

export function useMessageSendAnimation({
  onAnimationComplete,
  messageIndex,
  isUserMessage
}: UseMessageSendAnimationOptions) {
  const [isAnimating, setIsAnimating] = useState(false)
  const [shouldFadeIn, setShouldFadeIn] = useState(false)
  const messageRef = useRef<HTMLDivElement>(null)
  const translateY = useMotionValue(0)
  const opacity = useMotionValue(1)

  useEffect(() => {
    if (!isUserMessage || !messageRef.current) return

    // ì‚¬ìš©ì ë©”ì‹œì§€ ì „ì†¡ ì‹œ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
    const startAnimation = () => {
      setIsAnimating(true)
      const messageHeight = messageRef.current?.offsetHeight || 0
      const viewportHeight = window.innerHeight

      // ìœ„ë¡œ ìŠ¬ë¼ì´ë“œí•˜ë©´ì„œ í˜ì´ë“œì•„ì›ƒ
      animate(translateY, -viewportHeight, {
        duration: 0.4,
        ease: [0.4, 0, 0.2, 1] // ease-out
      })

      animate(opacity, 0, {
        duration: 0.3,
        ease: 'easeOut'
      }).then(() => {
        setIsAnimating(false)
        onAnimationComplete?.()
        // ë‹¤ìŒ ë©”ì‹œì§€(ì–´ì‹œìŠ¤í„´íŠ¸) í˜ì´ë“œì¸ ì‹œì‘
        setShouldFadeIn(true)
      })
    }

    // ë©”ì‹œì§€ê°€ ì¶”ê°€ëœ ì§í›„ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
    const timer = setTimeout(startAnimation, 50)
    return () => clearTimeout(timer)
  }, [messageIndex, isUserMessage, translateY, opacity, onAnimationComplete])

  return {
    messageRef,
    translateY,
    opacity,
    isAnimating,
    shouldFadeIn,
    style: {
      transform: `translateY(${translateY.get()}px)`,
      opacity: opacity.get()
    }
  }
}
```

#### 3.2.2 ë©”ì‹œì§€ ì»´í¬ë„ŒíŠ¸ ìˆ˜ì •

```typescript
// frontend/components/chat/AnimatedMessage.tsx

'use client'

import { motion } from 'framer-motion'
import { useMessageSendAnimation } from '@/hooks/useMessageSendAnimation'

interface AnimatedMessageProps {
  message: Message
  index: number
  onAnimationComplete?: () => void
  children: React.ReactNode
}

export function AnimatedMessage({ 
  message, 
  index, 
  onAnimationComplete,
  children 
}: AnimatedMessageProps) {
  const isUserMessage = message.role === 'user'
  const { messageRef, translateY, opacity, isAnimating, shouldFadeIn } = useMessageSendAnimation({
    onAnimationComplete,
    messageIndex: index,
    isUserMessage
  })

  // ì–´ì‹œìŠ¤í„´íŠ¸ ë©”ì‹œì§€ í˜ì´ë“œì¸
  const assistantFadeIn = !isUserMessage && shouldFadeIn

  return (
    <motion.div
      ref={messageRef}
      initial={assistantFadeIn ? { opacity: 0, y: 20 } : false}
      animate={assistantFadeIn ? { opacity: 1, y: 0 } : {}}
      transition={{
        duration: 0.35,
        ease: 'easeOut'
      }}
      style={isUserMessage ? {
        transform: `translateY(${translateY.get()}px)`,
        opacity: opacity.get()
      } : {}}
      className={`flex ${
        message.role === 'user' ? 'justify-end' : 'justify-start'
      }`}
    >
      {children}
    </motion.div>
  )
}
```

### 3.3 í”Œë¡œíŒ… ì»´í¬ì € (Glass Morphism)

#### 3.3.1 ì»´í¬ì € ì»´í¬ë„ŒíŠ¸

```typescript
// frontend/components/chat/FloatingComposer.tsx

'use client'

import { useState, useRef, useEffect } from 'react'
import { motion, useMotionValue, useSpring } from 'framer-motion'

interface FloatingComposerProps {
  value: string
  onChange: (value: string) => void
  onSend: () => void
  disabled?: boolean
  placeholder?: string
}

export function FloatingComposer({
  value,
  onChange,
  onSend,
  disabled,
  placeholder
}: FloatingComposerProps) {
  const [composerHeight, setComposerHeight] = useState(48)
  const textareaRef = useRef<HTMLTextAreaElement>(null)
  const y = useMotionValue(0)
  const springY = useSpring(y, { stiffness: 300, damping: 30 })

  // í‚¤ë³´ë“œ ë†’ì´ ê°ì§€
  useEffect(() => {
    const handleResize = () => {
      const viewportHeight = window.visualViewport?.height || window.innerHeight
      const windowHeight = window.innerHeight
      const keyboardHeight = windowHeight - viewportHeight
      
      // í‚¤ë³´ë“œê°€ ì—´ë ¤ìˆìœ¼ë©´ ì»´í¬ì €ë¥¼ ìœ„ë¡œ ì´ë™
      y.set(keyboardHeight > 0 ? -keyboardHeight : 0)
    }

    window.visualViewport?.addEventListener('resize', handleResize)
    return () => window.visualViewport?.removeEventListener('resize', handleResize)
  }, [y])

  // í…ìŠ¤íŠ¸ ì…ë ¥ ë†’ì´ ì¡°ì •
  useEffect(() => {
    if (textareaRef.current) {
      textareaRef.current.style.height = 'auto'
      const newHeight = Math.min(textareaRef.current.scrollHeight, 120)
      textareaRef.current.style.height = `${newHeight}px`
      setComposerHeight(newHeight)
    }
  }, [value])

  return (
    <motion.div
      style={{ y: springY }}
      className="fixed bottom-0 left-0 right-0 z-50 px-4 pb-4 safe-area-pb"
    >
      <div className="max-w-3xl mx-auto">
        <div 
          className="relative backdrop-blur-xl bg-white/80 dark:bg-slate-900/80 border border-slate-200/50 dark:border-slate-700/50 rounded-2xl shadow-2xl"
          style={{
            backdropFilter: 'blur(20px) saturate(180%)',
            WebkitBackdropFilter: 'blur(20px) saturate(180%)',
            backgroundColor: 'rgba(255, 255, 255, 0.75)',
          }}
        >
          <div className="flex items-end gap-3 p-3">
            <div className="flex-1 relative">
              <textarea
                ref={textareaRef}
                value={value}
                onChange={(e) => onChange(e.target.value)}
                onKeyDown={(e) => {
                  if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault()
                    onSend()
                  }
                }}
                placeholder={placeholder}
                disabled={disabled}
                rows={1}
                className="w-full resize-none bg-transparent border-none outline-none text-base placeholder:text-slate-400 disabled:opacity-50 transition-all"
                style={{
                  minHeight: '48px',
                  maxHeight: '120px',
                }}
              />
            </div>
            <motion.button
              onClick={onSend}
              disabled={!value.trim() || disabled}
              whileHover={{ scale: 1.05 }}
              whileTap={{ scale: 0.95 }}
              className="px-5 py-3 bg-gradient-to-r from-primary to-primary/90 text-white rounded-xl font-medium disabled:opacity-50 disabled:cursor-not-allowed shadow-lg"
            >
              ì „ì†¡ â†’
            </motion.button>
          </div>
        </div>
      </div>
    </motion.div>
  )
}
```

### 3.4 ë™ì  ë†’ì´ ë° ìŠ¤í¬ë¡¤ ê´€ë¦¬

#### 3.4.1 Blank Size í›…

```typescript
// frontend/hooks/useMessageBlankSize.ts

import { useState, useEffect, useRef } from 'react'

export function useMessageBlankSize() {
  const [blankSize, setBlankSize] = useState(0)
  const messagesEndRef = useRef<HTMLDivElement>(null)
  const lastMessageRef = useRef<HTMLDivElement>(null)

  useEffect(() => {
    const calculateBlankSize = () => {
      if (!messagesEndRef.current || !lastMessageRef.current) return

      const messagesEnd = messagesEndRef.current.getBoundingClientRect()
      const lastMessage = lastMessageRef.current.getBoundingClientRect()
      const viewportHeight = window.innerHeight

      // ë§ˆì§€ë§‰ ë©”ì‹œì§€ í•˜ë‹¨ê³¼ ë·°í¬íŠ¸ ë ì‚¬ì´ì˜ ê±°ë¦¬
      const distance = viewportHeight - lastMessage.bottom
      setBlankSize(Math.max(0, distance))
    }

    calculateBlankSize()
    window.addEventListener('resize', calculateBlankSize)
    
    // ë©”ì‹œì§€ ë³€ê²½ ì‹œ ì¬ê³„ì‚°
    const observer = new MutationObserver(calculateBlankSize)
    if (messagesEndRef.current) {
      observer.observe(messagesEndRef.current, { childList: true, subtree: true })
    }

    return () => {
      window.removeEventListener('resize', calculateBlankSize)
      observer.disconnect()
    }
  }, [])

  return { blankSize, messagesEndRef, lastMessageRef }
}
```

#### 3.4.2 ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ ìˆ˜ì •

```typescript
// frontend/app/chat/page.tsx ìˆ˜ì •

import { useMessageBlankSize } from '@/hooks/useMessageBlankSize'

export default function ChatPage() {
  const { blankSize, messagesEndRef, lastMessageRef } = useMessageBlankSize()
  const [composerHeight, setComposerHeight] = useState(80) // ì»´í¬ì € ë†’ì´
  const [keyboardHeight, setKeyboardHeight] = useState(0)

  // í‚¤ë³´ë“œ ë†’ì´ ê°ì§€
  useEffect(() => {
    const handleResize = () => {
      const viewportHeight = window.visualViewport?.height || window.innerHeight
      const windowHeight = window.innerHeight
      setKeyboardHeight(Math.max(0, windowHeight - viewportHeight))
    }

    window.visualViewport?.addEventListener('resize', handleResize)
    return () => window.visualViewport?.removeEventListener('resize', handleResize)
  }, [])

  // ë©”ì‹œì§€ ì˜ì—­ ìŠ¤íƒ€ì¼
  const messagesContainerStyle = {
    paddingBottom: `${blankSize + composerHeight + keyboardHeight}px`
  }

  return (
    <div className="flex-1 overflow-y-auto px-4 lg:px-6 py-4 lg:py-6" style={messagesContainerStyle}>
      {/* ë©”ì‹œì§€ ëª©ë¡ */}
      {messages.map((message, index) => (
        <div
          key={index}
          ref={index === messages.length - 1 ? lastMessageRef : undefined}
        >
          {/* ë©”ì‹œì§€ ë‚´ìš© */}
        </div>
      ))}
      <div ref={messagesEndRef} />
    </div>
  )
}
```

### 3.5 ì»´í¬ì €ë¸” ì±„íŒ… êµ¬ì¡°

#### 3.5.1 Context Provider êµ¬ì¡°

```typescript
// frontend/contexts/ChatContext.tsx

'use client'

import { createContext, useContext, ReactNode } from 'react'

interface ChatContextValue {
  composerHeight: number
  setComposerHeight: (height: number) => void
  keyboardHeight: number
  setKeyboardHeight: (height: number) => void
  blankSize: number
  setBlankSize: (size: number) => void
  isStreaming: boolean
  setIsStreaming: (streaming: boolean) => void
}

const ChatContext = createContext<ChatContextValue | undefined>(undefined)

export function ChatProvider({ children }: { children: ReactNode }) {
  const [composerHeight, setComposerHeight] = useState(80)
  const [keyboardHeight, setKeyboardHeight] = useState(0)
  const [blankSize, setBlankSize] = useState(0)
  const [isStreaming, setIsStreaming] = useState(false)

  return (
    <ChatContext.Provider value={{
      composerHeight,
      setComposerHeight,
      keyboardHeight,
      setKeyboardHeight,
      blankSize,
      setBlankSize,
      isStreaming,
      setIsStreaming
    }}>
      {children}
    </ChatContext.Provider>
  )
}

export function useChatContext() {
  const context = useContext(ChatContext)
  if (!context) {
    throw new Error('useChatContext must be used within ChatProvider')
  }
  return context
}
```

#### 3.5.2 ê¸°ëŠ¥ë³„ í›… ë¶„ë¦¬

```typescript
// frontend/hooks/chat/useKeyboardAwareScroll.ts

import { useEffect } from 'react'
import { useChatContext } from '@/contexts/ChatContext'

export function useKeyboardAwareScroll() {
  const { keyboardHeight, blankSize, composerHeight } = useChatContext()
  const messagesContainerRef = useRef<HTMLDivElement>(null)

  useEffect(() => {
    if (!messagesContainerRef.current) return

    // í‚¤ë³´ë“œê°€ ì—´ë¦´ ë•Œ ìŠ¤í¬ë¡¤ ì¡°ì •
    if (keyboardHeight > 0) {
      const container = messagesContainerRef.current
      const scrollDistance = blankSize + composerHeight + keyboardHeight
      
      container.scrollTo({
        top: container.scrollHeight,
        behavior: 'smooth'
      })
    }
  }, [keyboardHeight, blankSize, composerHeight])

  return { messagesContainerRef }
}
```

### 3.6 ì¬ì• ë‹ˆë©”ì´ì…˜ ë°©ì§€

```typescript
// frontend/components/chat/DisableFadeProvider.tsx

'use client'

import { createContext, useContext, useState, ReactNode } from 'react'

const DisableFadeContext = createContext<{
  disabledMessageIds: Set<string>
  markAsSeen: (messageId: string) => void
}>({
  disabledMessageIds: new Set(),
  markAsSeen: () => {}
})

export function DisableFadeProvider({ children }: { children: ReactNode }) {
  const [disabledMessageIds, setDisabledMessageIds] = useState<Set<string>>(new Set())

  const markAsSeen = (messageId: string) => {
    setDisabledMessageIds(prev => new Set([...prev, messageId]))
  }

  return (
    <DisableFadeContext.Provider value={{ disabledMessageIds, markAsSeen }}>
      {children}
    </DisableFadeContext.Provider>
  )
}

export function useDisableFade() {
  return useContext(DisableFadeContext)
}
```

---

## 4. ìš°ì„ ìˆœìœ„ ë° ë¡œë“œë§µ

### Phase 1: í•µì‹¬ UX ê°œì„  (1ì£¼)

**ëª©í‘œ**: ì‚¬ìš©ìê°€ ê°€ì¥ ì²´ê°í•  ìˆ˜ ìˆëŠ” ê°œì„  ì‚¬í•­ ìš°ì„  êµ¬í˜„

1. **ìŠ¤íŠ¸ë¦¬ë° ì½˜í…ì¸  ìŠ¤íƒœê±°ë“œ í˜ì´ë“œ ì• ë‹ˆë©”ì´ì…˜** (3ì¼)
   - `StaggeredFadeText` ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
   - í’€ ê¸°ë°˜ ì• ë‹ˆë©”ì´ì…˜ ê´€ë¦¬
   - ì±„íŒ… í˜ì´ì§€ í†µí•©

2. **ë©”ì‹œì§€ ì „ì†¡ ì• ë‹ˆë©”ì´ì…˜** (2ì¼)
   - `useMessageSendAnimation` í›… êµ¬í˜„
   - `AnimatedMessage` ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
   - í†µí•© ë° í…ŒìŠ¤íŠ¸

### Phase 2: ê³ ê¸‰ UX ê¸°ëŠ¥ (1ì£¼)

3. **í”Œë¡œíŒ… ì»´í¬ì €** (2ì¼)
   - Glass Morphism ìŠ¤íƒ€ì¼ ì ìš©
   - í‚¤ë³´ë“œ ìƒíƒœ ê°ì§€ ë° ìœ„ì¹˜ ì¡°ì •
   - ì»´í¬ì € ë†’ì´ ë™ì  ì²˜ë¦¬

4. **ë™ì  ë†’ì´ ë° ìŠ¤í¬ë¡¤ ê´€ë¦¬** (3ì¼)
   - `useMessageBlankSize` í›… êµ¬í˜„
   - ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ ìˆ˜ì •
   - í‚¤ë³´ë“œ ì¸ì‹ ê°œì„ 

### Phase 3: ì•„í‚¤í…ì²˜ ê°œì„  (1ì£¼)

5. **ì»´í¬ì €ë¸” ì±„íŒ… êµ¬ì¡°** (3ì¼)
   - Context Provider êµ¬ì¡° êµ¬ì¶•
   - ê¸°ëŠ¥ë³„ í›… ë¶„ë¦¬
   - ì¬ì• ë‹ˆë©”ì´ì…˜ ë°©ì§€ ì‹œìŠ¤í…œ

6. **í†µí•© ë° ìµœì í™”** (2ì¼)
   - ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸
   - ì„±ëŠ¥ ìµœì í™”
   - ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”

---

## 5. ê¸°ìˆ  ìŠ¤íƒ

### í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬

```json
{
  "dependencies": {
    "framer-motion": "^10.16.16", // ì• ë‹ˆë©”ì´ì…˜
    "react-intersection-observer": "^9.5.3" // ìŠ¤í¬ë¡¤ ê°ì§€
  }
}
```

### ì„ íƒì  ë¼ì´ë¸ŒëŸ¬ë¦¬

- `@react-spring/web`: ëŒ€ì•ˆ ì• ë‹ˆë©”ì´ì…˜ ë¼ì´ë¸ŒëŸ¬ë¦¬
- `react-use-measure`: ìš”ì†Œ í¬ê¸° ì¸¡ì •
- `use-gesture`: ì œìŠ¤ì²˜ ì²˜ë¦¬

---

## 6. ì˜ˆìƒ íš¨ê³¼

### ì‚¬ìš©ì ê²½í—˜
- âœ… ë” ìì—°ìŠ¤ëŸ¬ìš´ AI ì‘ë‹µ ê²½í—˜
- âœ… ë©”ì‹œì§€ ì „ì†¡ì˜ ì‹œê°ì  í”¼ë“œë°± ê°•í™”
- âœ… ë„¤ì´í‹°ë¸Œ ì•± ìˆ˜ì¤€ì˜ ë¶€ë“œëŸ¬ìš´ ëŠë‚Œ
- âœ… ëª¨ë°”ì¼ ê²½í—˜ í–¥ìƒ

### ê¸°ìˆ ì  ì´ì 
- âœ… ëª¨ë“ˆí™”ëœ êµ¬ì¡°ë¡œ í™•ì¥ì„± í–¥ìƒ
- âœ… ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸ ë° í›…
- âœ… ì„±ëŠ¥ ìµœì í™”ëœ ì• ë‹ˆë©”ì´ì…˜

---

**ì‘ì„±ì**: AI Assistant  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2024-12-19  
**ë‹¤ìŒ ê²€í†  ì˜ˆì •ì¼**: Phase 1 ì™„ë£Œ í›„

